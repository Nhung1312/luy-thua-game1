<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√≤ Ch∆°i √în T·∫≠p L≈©y Th·ª´a - To√°n 6</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
        }
        .timer-warning { 
            animation: pulse 1s infinite; 
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .correct-answer { 
            animation: correctBounce 0.6s ease-out; 
        }
        .wrong-answer { 
            animation: wrongShake 0.6s ease-out; 
        }
        .success-flash {
            animation: successFlash 0.8s ease-out;
        }
        .error-flash {
            animation: errorFlash 0.8s ease-out;
        }
        @keyframes correctBounce {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        @keyframes successFlash {
            0% { background-color: rgba(34, 197, 94, 0); }
            50% { background-color: rgba(34, 197, 94, 0.2); }
            100% { background-color: rgba(34, 197, 94, 0); }
        }
        @keyframes errorFlash {
            0% { background-color: rgba(239, 68, 68, 0); }
            50% { background-color: rgba(239, 68, 68, 0.2); }
            100% { background-color: rgba(239, 68, 68, 0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 min-h-screen transition-all duration-300">
    <div class="container mx-auto px-2 sm:px-4 py-4 sm:py-8 max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-4 sm:mb-6">
            <div class="flex justify-between items-center mb-3 sm:mb-4">
                <div></div>
                <button id="themeToggle" onclick="toggleTheme()" class="p-2 rounded-lg bg-white dark:bg-gray-800 shadow-md hover:shadow-lg transition-all duration-300">
                    <span id="themeIcon" class="text-xl">üåô</span>
                </button>
            </div>
            <h1 class="text-2xl sm:text-4xl font-bold text-indigo-800 dark:text-indigo-300 mb-2">üéØ Tr√≤ Ch∆°i L≈©y Th·ª´a</h1>
            <p class="text-sm sm:text-lg text-gray-600 dark:text-gray-400 px-2">√în t·∫≠p c√¥ng th·ª©c l≈©y th·ª´a v·ªõi s·ªë m≈© t·ª± nhi√™n - To√°n 6</p>
        </div>

        <!-- Start Screen -->
        <div id="startScreen" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-4 sm:p-8">
            <div class="text-center mb-4 sm:mb-6">
                <div class="text-4xl sm:text-6xl mb-3 sm:mb-4">üìö</div>
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200 mb-3 sm:mb-4">H∆∞·ªõng D·∫´n Ch∆°i</h2>
            </div>

            <!-- C√¥ng th·ª©c t√≥m t·∫Øt -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900 dark:to-indigo-900 rounded-xl p-3 sm:p-6 mb-4 sm:mb-6">
                <h3 class="font-bold text-indigo-800 dark:text-indigo-300 mb-3 sm:mb-4 text-center text-sm sm:text-base">üìã T√≥m T·∫Øt C√¥ng Th·ª©c L≈©y Th·ª´a</h3>
                <div class="grid grid-cols-1 gap-3 sm:gap-4 text-xs sm:text-sm">
                    <div class="bg-white dark:bg-gray-700 rounded-lg p-3 sm:p-4">
                        <h4 class="font-semibold text-blue-700 dark:text-blue-400 mb-2">ƒê·ªãnh nghƒ©a:</h4>
                        <p class="text-gray-700 dark:text-gray-300">a<sup>n</sup> = a √ó a √ó ... √ó a (n l·∫ßn)</p>
                        <p class="text-gray-600 dark:text-gray-400 text-xs mt-1">a: c∆° s·ªë, n: s·ªë m≈©</p>
                    </div>
                    <div class="bg-white dark:bg-gray-700 rounded-lg p-3 sm:p-4">
                        <h4 class="font-semibold text-blue-700 dark:text-blue-400 mb-2">L≈©y th·ª´a v·ªõi s·ªë m≈© 0:</h4>
                        <p class="text-gray-700 dark:text-gray-300">a<sup>0</sup> = 1 (a ‚â† 0)</p>
                    </div>
                    <div class="bg-white dark:bg-gray-700 rounded-lg p-3 sm:p-4">
                        <h4 class="font-semibold text-blue-700 dark:text-blue-400 mb-2">Nh√¢n hai l≈©y th·ª´a c√πng c∆° s·ªë:</h4>
                        <p class="text-gray-700 dark:text-gray-300">a<sup>m</sup> √ó a<sup>n</sup> = a<sup>m+n</sup></p>
                    </div>
                    <div class="bg-white dark:bg-gray-700 rounded-lg p-3 sm:p-4">
                        <h4 class="font-semibold text-blue-700 dark:text-blue-400 mb-2">Chia hai l≈©y th·ª´a c√πng c∆° s·ªë:</h4>
                        <p class="text-gray-700 dark:text-gray-300">a<sup>m</sup> : a<sup>n</sup> = a<sup>m-n</sup> (a ‚â† 0)</p>
                    </div>
                </div>
            </div>

            <div class="bg-blue-50 dark:bg-blue-900 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6">
                <h3 class="font-semibold text-blue-800 dark:text-blue-300 mb-2 text-sm sm:text-base">Quy t·∫Øc ch∆°i:</h3>
                <ul class="text-left text-blue-700 dark:text-blue-400 space-y-1 text-xs sm:text-sm">
                    <li>‚Ä¢ 32 c√¢u h·ªèi v·ªõi 5 m·ª©c ƒë·ªô kh√≥ tƒÉng d·∫ßn</li>
                    <li>‚Ä¢ M·ªói c√¢u c√≥ 60 gi√¢y ƒë·ªÉ tr·∫£ l·ªùi</li>
                    <li>‚Ä¢ 4 ƒë√°p √°n l·ª±a ch·ªçn cho m·ªói c√¢u</li>
                    <li>‚Ä¢ C√≥ g·ª£i √Ω khi tr·∫£ l·ªùi sai</li>
                    <li>‚Ä¢ M·ªói c√¢u tr·∫£ l·ªùi ƒë√∫ng ƒë∆∞·ª£c 1 ƒëi·ªÉm</li>
                    <li>‚Ä¢ C√¢u h·ªèi ƒë∆∞·ª£c x√°o tr·ªôn m·ªói l·∫ßn ch∆°i</li>
                </ul>
            </div>

            <div class="text-center">
                <button onclick="startGame()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 sm:px-8 rounded-xl text-base sm:text-lg transition-all duration-300 transform hover:scale-105 w-full sm:w-auto">
                    üöÄ B·∫Øt ƒê·∫ßu Ch∆°i
                </button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="hidden">
            <!-- Progress Bar -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-3 sm:p-4 mb-3 sm:mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400">C√¢u <span id="currentQuestion">1</span>/32</span>
                    <span class="text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400">ƒêi·ªÉm: <span id="currentScore">0</span></span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 sm:h-3">
                    <div id="progressBar" class="bg-indigo-600 dark:bg-indigo-500 h-2 sm:h-3 rounded-full transition-all duration-300" style="width: 5%"></div>
                </div>
            </div>

            <!-- Timer -->
            <div class="text-center mb-3 sm:mb-4">
                <div id="timer" class="inline-block bg-red-500 dark:bg-red-600 text-white font-bold py-2 px-3 sm:px-4 rounded-full text-lg sm:text-xl">60</div>
            </div>

            <!-- Question Card -->
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-4 sm:p-8 mb-3 sm:mb-4">
                <div class="mb-3 sm:mb-4">
                    <span id="questionLevel" class="inline-block bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 text-xs sm:text-sm font-medium px-2 sm:px-3 py-1 rounded-full">Nh·∫≠n bi·∫øt</span>
                </div>
                <h2 id="questionText" class="text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-200 mb-4 sm:mb-6 leading-relaxed">C√¢u h·ªèi s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</h2>
                
                <div class="grid grid-cols-1 gap-3 sm:gap-4">
                    <button class="answer-btn bg-gray-50 dark:bg-gray-700 hover:bg-blue-50 dark:hover:bg-blue-900 border-2 border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 rounded-xl p-3 sm:p-4 text-left transition-all duration-300" onclick="selectAnswer(0)">
                        <span class="font-medium text-blue-600 dark:text-blue-400">A.</span> <span class="answer-text ml-2 text-gray-800 dark:text-gray-200 text-sm sm:text-base"></span>
                    </button>
                    <button class="answer-btn bg-gray-50 dark:bg-gray-700 hover:bg-blue-50 dark:hover:bg-blue-900 border-2 border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 rounded-xl p-3 sm:p-4 text-left transition-all duration-300" onclick="selectAnswer(1)">
                        <span class="font-medium text-blue-600 dark:text-blue-400">B.</span> <span class="answer-text ml-2 text-gray-800 dark:text-gray-200 text-sm sm:text-base"></span>
                    </button>
                    <button class="answer-btn bg-gray-50 dark:bg-gray-700 hover:bg-blue-50 dark:hover:bg-blue-900 border-2 border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 rounded-xl p-3 sm:p-4 text-left transition-all duration-300" onclick="selectAnswer(2)">
                        <span class="font-medium text-blue-600 dark:text-blue-400">C.</span> <span class="answer-text ml-2 text-gray-800 dark:text-gray-200 text-sm sm:text-base"></span>
                    </button>
                    <button class="answer-btn bg-gray-50 dark:bg-gray-700 hover:bg-blue-50 dark:hover:bg-blue-900 border-2 border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 rounded-xl p-3 sm:p-4 text-left transition-all duration-300" onclick="selectAnswer(3)">
                        <span class="font-medium text-blue-600 dark:text-blue-400">D.</span> <span class="answer-text ml-2 text-gray-800 dark:text-gray-200 text-sm sm:text-base"></span>
                    </button>
                </div>
            </div>

            <!-- Hint Section -->
            <div id="hintSection" class="hidden bg-yellow-50 dark:bg-yellow-900 border-l-4 border-yellow-400 dark:border-yellow-500 p-3 sm:p-4 rounded-r-xl mb-3 sm:mb-4">
                <div class="flex items-start">
                    <div class="text-yellow-400 dark:text-yellow-300 text-lg sm:text-xl mr-3 mt-1">üí°</div>
                    <div>
                        <h3 class="text-yellow-800 dark:text-yellow-300 font-medium text-sm sm:text-base">G·ª£i √Ω:</h3>
                        <p id="hintText" class="text-yellow-700 dark:text-yellow-400 mt-1 text-sm sm:text-base"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="resultScreen" class="hidden bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-4 sm:p-8 text-center">
            <div class="mb-4 sm:mb-6">
                <div id="resultEmoji" class="text-4xl sm:text-6xl mb-3 sm:mb-4">üéâ</div>
                <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 dark:text-gray-200 mb-3 sm:mb-4">K·∫øt Qu·∫£</h2>
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900 dark:to-indigo-900 rounded-xl p-4 sm:p-6 mb-4 sm:mb-6">
                    <div class="text-3xl sm:text-4xl font-bold text-indigo-600 dark:text-indigo-400 mb-2" id="finalScore">0</div>
                    <div class="text-base sm:text-lg text-gray-600 dark:text-gray-400 mb-2">ƒëi·ªÉm</div>
                    <div class="text-sm text-gray-500 dark:text-gray-500" id="correctAnswers">0/32 c√¢u ƒë√∫ng</div>
                    <div class="text-xs sm:text-sm text-gray-500 dark:text-gray-500 mt-2" id="totalScore">T·ªïng ƒëi·ªÉm t√≠ch l≈©y: 0</div>
                </div>
                <div id="resultMessage" class="text-base sm:text-lg text-gray-700 dark:text-gray-300 mb-4 sm:mb-6 px-2"></div>
            </div>
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center">
                <button onclick="restartGame()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 text-sm sm:text-base">
                    üîÑ Ch∆°i L·∫°i
                </button>
                <button onclick="reviewAnswers()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 text-sm sm:text-base">
                    üìã Xem ƒê√°p √Ån
                </button>
            </div>
        </div>

        <!-- Review Screen -->
        <div id="reviewScreen" class="hidden">
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-4 sm:p-8">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200 mb-4 sm:mb-6 text-center">üìã Xem L·∫°i ƒê√°p √Ån</h2>
                <div id="reviewContent" class="space-y-3 sm:space-y-4 max-h-80 sm:max-h-96 overflow-y-auto"></div>
                <div class="text-center mt-4 sm:mt-6">
                    <button onclick="backToResult()" class="bg-gray-600 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 text-sm sm:text-base w-full sm:w-auto">
                        ‚Üê Quay L·∫°i
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game data - Expanded with more levels
        const questions = [
            // Nh·∫≠n bi·∫øt (6 c√¢u)
            {
                level: "Nh·∫≠n bi·∫øt",
                question: "2¬≥ c√≥ nghƒ©a l√† g√¨?",
                answers: ["2 + 2 + 2", "2 √ó 2 √ó 2", "2 √ó 3", "3 √ó 3"],
                correct: 1,
                hint: "L≈©y th·ª´a c√≥ nghƒ©a l√† nh√¢n m·ªôt s·ªë v·ªõi ch√≠nh n√≥ nhi·ªÅu l·∫ßn."
            },
            {
                level: "Nh·∫≠n bi·∫øt",
                question: "Trong l≈©y th·ª´a 5‚Å¥, s·ªë 5 ƒë∆∞·ª£c g·ªçi l√† g√¨?",
                answers: ["S·ªë m≈©", "C∆° s·ªë", "K·∫øt qu·∫£", "L≈©y th·ª´a"],
                correct: 1,
                hint: "S·ªë ƒë∆∞·ª£c vi·∫øt to h∆°n ·ªü d∆∞·ªõi ƒë∆∞·ª£c g·ªçi l√† c∆° s·ªë."
            },
            {
                level: "Nh·∫≠n bi·∫øt",
                question: "7‚Å∞ b·∫±ng bao nhi√™u?",
                answers: ["0", "7", "1", "Kh√¥ng x√°c ƒë·ªãnh"],
                correct: 2,
                hint: "B·∫•t k·ª≥ s·ªë n√†o (kh√°c 0) m≈© 0 ƒë·ªÅu b·∫±ng 1."
            },
            {
                level: "Nh·∫≠n bi·∫øt",
                question: "4¬≤ b·∫±ng bao nhi√™u?",
                answers: ["8", "12", "6", "16"],
                correct: 3,
                hint: "4¬≤ = 4 √ó 4"
            },
            {
                level: "Nh·∫≠n bi·∫øt",
                question: "10¬≥ b·∫±ng bao nhi√™u?",
                answers: ["30", "100", "1000", "300"],
                correct: 2,
                hint: "10¬≥ = 10 √ó 10 √ó 10"
            },
            {
                level: "Nh·∫≠n bi·∫øt",
                question: "3‚Å¥ b·∫±ng bao nhi√™u?",
                answers: ["12", "64", "81", "27"],
                correct: 2,
                hint: "3‚Å¥ = 3 √ó 3 √ó 3 √ó 3"
            },

            // Th√¥ng hi·ªÉu (7 c√¢u)
            {
                level: "Th√¥ng hi·ªÉu",
                question: "2¬≥ √ó 2¬≤ b·∫±ng bao nhi√™u?",
                answers: ["2‚Å∂", "4‚Åµ", "8", "2‚Åµ"],
                correct: 3,
                hint: "S·ª≠ d·ª•ng c√¥ng th·ª©c: a·µê √ó a‚Åø = a·µê‚Å∫‚Åø"
            },
            {
                level: "Th√¥ng hi·ªÉu",
                question: "3‚Å∂ : 3¬≤ b·∫±ng bao nhi√™u?",
                answers: ["3¬≥", "9‚Å¥", "81", "3‚Å¥"],
                correct: 3,
                hint: "S·ª≠ d·ª•ng c√¥ng th·ª©c: a·µê : a‚Åø = a·µê‚Åª‚Åø"
            },
            {
                level: "Th√¥ng hi·ªÉu",
                question: "(2¬≥)¬≤ b·∫±ng bao nhi√™u?",
                answers: ["2‚Åµ", "4¬≥", "64", "2‚Å∂"],
                correct: 3,
                hint: "S·ª≠ d·ª•ng c√¥ng th·ª©c: (a·µê)‚Åø = a·µêÀ£‚Åø"
            },
            {
                level: "Th√¥ng hi·ªÉu",
                question: "Vi·∫øt 64 d∆∞·ªõi d·∫°ng l≈©y th·ª´a c·ªßa 2:",
                answers: ["2‚Åµ", "2‚Å∑", "2‚Å¥", "2‚Å∂"],
                correct: 3,
                hint: "Th·ª≠ chia 64 cho 2 li√™n ti·∫øp ƒë·ªÉ t√¨m s·ªë m≈©."
            },
            {
                level: "Th√¥ng hi·ªÉu",
                question: "T√¨m x bi·∫øt: 2À£ = 32",
                answers: ["x = 4", "x = 6", "x = 3", "x = 5"],
                correct: 3,
                hint: "32 = 2 √ó 2 √ó 2 √ó 2 √ó 2, ƒë·∫øm s·ªë l·∫ßn nh√¢n."
            },
            {
                level: "Th√¥ng hi·ªÉu",
                question: "5¬≥ : 5¬π b·∫±ng bao nhi√™u?",
                answers: ["5¬≤", "5‚Å¥", "25", "125"],
                correct: 0,
                hint: "S·ª≠ d·ª•ng c√¥ng th·ª©c: a·µê : a‚Åø = a·µê‚Åª‚Åø, n√™n 5¬≥ : 5¬π = 5¬≥‚Åª¬π = 5¬≤"
            },
            {
                level: "Th√¥ng hi·ªÉu",
                question: "Vi·∫øt 125 d∆∞·ªõi d·∫°ng l≈©y th·ª´a c·ªßa 5:",
                answers: ["5¬≤", "5‚Å¥", "5¬≥", "5‚Åµ"],
                correct: 2,
                hint: "125 = 5 √ó 5 √ó 5 = 5¬≥"
            },

            // V·∫≠n d·ª•ng (7 c√¢u)
            {
                level: "V·∫≠n d·ª•ng",
                question: "T√≠nh gi√° tr·ªã c·ªßa bi·ªÉu th·ª©c: 3¬≤ + 2¬≥",
                answers: ["11", "17", "13", "15"],
                correct: 1,
                hint: "T√≠nh 3¬≤ = 9 v√† 2¬≥ = 8, r·ªìi c·ªông l·∫°i."
            },
            {
                level: "V·∫≠n d·ª•ng",
                question: "T√¨m c∆° s·ªë a bi·∫øt: a¬≥ = 27",
                answers: ["a = 9", "a = 6", "a = 12", "a = 3"],
                correct: 3,
                hint: "T√¨m s·ªë n√†o nh√¢n v·ªõi ch√≠nh n√≥ 3 l·∫ßn b·∫±ng 27."
            },
            {
                level: "V·∫≠n d·ª•ng",
                question: "T√≠nh gi√° tr·ªã c·ªßa bi·ªÉu th·ª©c: 2¬≥ √ó 3¬≤ - 4¬≤",
                answers: ["64", "48", "72", "56"],
                correct: 3,
                hint: "T√≠nh t·ª´ng l≈©y th·ª´a tr∆∞·ªõc: 2¬≥ = 8, 3¬≤ = 9, 4¬≤ = 16."
            },
            {
                level: "V·∫≠n d·ª•ng",
                question: "So s√°nh: 2¬π‚Å∞ v√† 10¬≥",
                answers: ["2¬π‚Å∞ > 10¬≥", "2¬π‚Å∞ < 10¬≥", "2¬π‚Å∞ = 10¬≥", "Kh√¥ng so s√°nh ƒë∆∞·ª£c"],
                correct: 0,
                hint: "T√≠nh 2¬π‚Å∞ = 1024 v√† 10¬≥ = 1000."
            },
            {
                level: "V·∫≠n d·ª•ng",
                question: "T√≠nh: (2¬≤)¬≥ + (3¬≤)¬≤",
                answers: ["97", "89", "81", "145"],
                correct: 3,
                hint: "(2¬≤)¬≥ = 2‚Å∂ = 64 v√† (3¬≤)¬≤ = 3‚Å¥ = 81, r·ªìi c·ªông l·∫°i."
            },
            {
                level: "V·∫≠n d·ª•ng",
                question: "T√¨m x bi·∫øt: 3À£‚Å∫¬π = 81",
                answers: ["x = 3", "x = 4", "x = 2", "x = 5"],
                correct: 0,
                hint: "81 = 3‚Å¥, n√™n 3À£‚Å∫¬π = 3‚Å¥, suy ra x + 1 = 4"
            },
            {
                level: "V·∫≠n d·ª•ng",
                question: "So s√°nh: 3‚Åµ v√† 5¬≥",
                answers: ["3‚Åµ > 5¬≥", "3‚Åµ < 5¬≥", "3‚Åµ = 5¬≥", "Kh√¥ng so s√°nh ƒë∆∞·ª£c"],
                correct: 1,
                hint: "T√≠nh 3‚Åµ = 243 v√† 5¬≥ = 125, so s√°nh k·∫øt qu·∫£."
            },

            // V·∫≠n d·ª•ng cao (6 c√¢u)
            {
                level: "V·∫≠n d·ª•ng cao",
                question: "T√≠nh: (2¬≥ + 3¬≤)¬≤ - (2¬≤ + 3¬≥)¬≤",
                answers: ["-527", "-625", "-729", "-343"],
                correct: 0,
                hint: "T√≠nh t·ª´ng ngo·∫∑c: (8+9)¬≤ - (4+27)¬≤ = 17¬≤ - 31¬≤ = 289 - 961"
            },
            {
                level: "V·∫≠n d·ª•ng cao",
                question: "T√¨m x bi·∫øt: 2À£ + 2À£‚Å∫¬π + 2À£‚Å∫¬≤ = 112",
                answers: ["x = 4", "x = 5", "x = 3", "x = 6"],
                correct: 0,
                hint: "ƒê·∫∑t 2À£ = a, ta c√≥: a + 2a + 4a = 7a = 112, n√™n a = 16 = 2‚Å¥"
            },
            {
                level: "V·∫≠n d·ª•ng cao",
                question: "So s√°nh: 2¬≤‚Å∞ v√† 3¬π¬≥",
                answers: ["2¬≤‚Å∞ > 3¬π¬≥", "2¬≤‚Å∞ < 3¬π¬≥", "2¬≤‚Å∞ = 3¬π¬≥", "Kh√¥ng x√°c ƒë·ªãnh"],
                correct: 1,
                hint: "2¬≤‚Å∞ = (2‚Å¥)‚Åµ = 16‚Åµ v√† 3¬π¬≥ = 3¬π¬≥. So s√°nh 16‚Åµ v·ªõi 3¬π¬≥"
            },
            {
                level: "V·∫≠n d·ª•ng cao",
                question: "T√≠nh: 4¬≥ √ó 8¬≤ : 2‚Åπ",
                answers: ["2", "4", "8", "1"],
                correct: 0,
                hint: "Vi·∫øt t·∫•t c·∫£ v·ªÅ c∆° s·ªë 2: 4¬≥ = (2¬≤)¬≥ = 2‚Å∂, 8¬≤ = (2¬≥)¬≤ = 2‚Å∂"
            },
            {
                level: "V·∫≠n d·ª•ng cao",
                question: "T√¨m s·ªë t·ª± nhi√™n n sao cho: 3‚Åø‚Å∫¬π - 3‚Åø = 162",
                answers: ["n = 4", "n = 5", "n = 3", "n = 6"],
                correct: 0,
                hint: "3‚Åø‚Å∫¬π - 3‚Åø = 3‚Åø(3-1) = 2√ó3‚Åø = 162, n√™n 3‚Åø = 81 = 3‚Å¥"
            },
            {
                level: "V·∫≠n d·ª•ng cao",
                question: "T√≠nh gi√° tr·ªã c·ªßa A = 2‚Å∂ + 2‚Åµ + 2‚Å¥ + 2¬≥ + 2¬≤ + 2¬π + 2‚Å∞",
                answers: ["127", "128", "255", "256"],
                correct: 0,
                hint: "ƒê√¢y l√† t·ªïng c·∫•p s·ªë nh√¢n: A = 2‚Å∑ - 1 = 128 - 1 = 127"
            },

            // Th√°ch th·ª©c (6 c√¢u)
            {
                level: "Th√°ch th·ª©c",
                question: "T√¨m ch·ªØ s·ªë t·∫≠n c√πng c·ªßa 2¬≤‚Å∞¬≤‚Å¥",
                answers: ["2", "4", "6", "8"],
                correct: 2,
                hint: "Chu k·ª≥ t·∫≠n c√πng c·ªßa l≈©y th·ª´a 2: 2,4,8,6,2,4,8,6... (chu k·ª≥ 4)"
            },
            {
                level: "Th√°ch th·ª©c",
                question: "Cho 2À£ = 3 ∏ = 6·∂ª. T√¨m m·ªëi quan h·ªá gi·ªØa x, y, z:",
                answers: ["1/x + 1/y = 1/z", "x + y = z", "1/z = 1/x + 1/y", "xyz = 1"],
                correct: 2,
                hint: "ƒê·∫∑t 2À£ = 3 ∏ = 6·∂ª = k. T·ª´ ƒë√≥ suy ra x, y, z theo k"
            },
            {
                level: "Th√°ch th·ª©c",
                question: "T√≠nh: (‚àö2)‚Å∏ √ó (‚àö3)‚Å∂ √ó (‚àö6)‚Å¥",
                answers: ["144", "216", "288", "432"],
                correct: 1,
                hint: "(‚àö2)‚Å∏ = 2‚Å¥ = 16, (‚àö3)‚Å∂ = 3¬≥ = 27, (‚àö6)‚Å¥ = 6¬≤ = 36"
            },
            {
                level: "Th√°ch th·ª©c",
                question: "T√¨m x bi·∫øt: 9À£ - 3À£‚Å∫¬π = 162",
                answers: ["x = 3", "x = 4", "x = 2", "x = 5"],
                correct: 0,
                hint: "9À£ = (3¬≤)À£ = 3¬≤À£. Ph∆∞∆°ng tr√¨nh tr·ªü th√†nh: 3¬≤À£ - 3√ó3À£ = 162"
            },
            {
                level: "Th√°ch th·ª©c",
                question: "So s√°nh: 2¬≥‚Å∞‚Å∞ v√† 3¬≤‚Å∞‚Å∞",
                answers: ["2¬≥‚Å∞‚Å∞ > 3¬≤‚Å∞‚Å∞", "2¬≥‚Å∞‚Å∞ < 3¬≤‚Å∞‚Å∞", "2¬≥‚Å∞‚Å∞ = 3¬≤‚Å∞‚Å∞", "Kh√¥ng so s√°nh ƒë∆∞·ª£c"],
                correct: 1,
                hint: "So s√°nh (2¬≥)¬π‚Å∞‚Å∞ v√† (3¬≤)¬π‚Å∞‚Å∞, t·ª©c l√† 8¬π‚Å∞‚Å∞ v√† 9¬π‚Å∞‚Å∞"
            },
            {
                level: "Th√°ch th·ª©c",
                question: "T√≠nh t·ªïng: S = 1 + 3 + 3¬≤ + 3¬≥ + ... + 3¬π‚Å∞",
                answers: ["88573", "177146", "59049", "44286"],
                correct: 0,
                hint: "T·ªïng c·∫•p s·ªë nh√¢n: S = (3¬π¬π - 1)/(3 - 1) = (177147 - 1)/2"
            }
        ];

        // Game state
        let currentQuestionIndex = 0;
        let score = 0;
        let correctAnswersCount = 0;
        let timeLeft = 60;
        let timer;
        let userAnswers = [];
        let shuffledQuestions = [];
        let isDarkMode = true;
        let totalScore = 0;

        // Sound functions using Web Audio API
        function createAudioContext() {
            return new (window.AudioContext || window.webkitAudioContext)();
        }

        function playCorrectSound() {
            try {
                const audioContext = createAudioContext();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Success sound: ascending notes
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.4);
                
                // Add visual flash effect
                document.body.classList.add('success-flash');
                setTimeout(() => document.body.classList.remove('success-flash'), 800);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function playWrongSound() {
            try {
                const audioContext = createAudioContext();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Error sound: descending notes
                oscillator.frequency.setValueAtTime(400, audioContext.currentTime); // Lower frequency
                oscillator.frequency.setValueAtTime(300, audioContext.currentTime + 0.15);
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime + 0.3);
                
                oscillator.type = 'sawtooth';
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
                
                // Add visual flash effect
                document.body.classList.add('error-flash');
                setTimeout(() => document.body.classList.remove('error-flash'), 800);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function playTickSound() {
            try {
                const audioContext = createAudioContext();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Tick sound: short beep
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.type = 'square';
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        // Load saved theme and total score
        function loadTheme() {
            const savedTheme = localStorage.getItem('powerGameTheme');
            // Default to dark theme if no saved preference
            if (savedTheme === 'light') {
                isDarkMode = false;
                document.documentElement.classList.remove('dark');
                document.getElementById('themeIcon').textContent = 'üåô';
            } else {
                // Default dark theme
                isDarkMode = true;
                document.documentElement.classList.add('dark');
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
                if (!savedTheme) {
                    localStorage.setItem('powerGameTheme', 'dark');
                }
            }
            
            // Load total score
            const savedTotalScore = localStorage.getItem('powerGameTotalScore');
            if (savedTotalScore) {
                totalScore = parseInt(savedTotalScore);
            }
        }

        // Toggle theme
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
                localStorage.setItem('powerGameTheme', 'dark');
            } else {
                document.documentElement.classList.remove('dark');
                document.getElementById('themeIcon').textContent = 'üåô';
                localStorage.setItem('powerGameTheme', 'light');
            }
        }

        // Shuffle array function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startGame() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            currentQuestionIndex = 0;
            score = 0;
            correctAnswersCount = 0;
            userAnswers = [];
            
            shuffledQuestions = shuffleArray(questions);
            
            loadQuestion();
        }

        function loadQuestion() {
            const question = shuffledQuestions[currentQuestionIndex];
            
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('currentScore').textContent = score;
            document.getElementById('progressBar').style.width = ((currentQuestionIndex + 1) / shuffledQuestions.length) * 100 + '%';
            
            document.getElementById('questionLevel').textContent = question.level;
            document.getElementById('questionLevel').className = `inline-block text-sm font-medium px-3 py-1 rounded-full ${
                question.level === 'Nh·∫≠n bi·∫øt' ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300' :
                question.level === 'Th√¥ng hi·ªÉu' ? 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300' :
                question.level === 'V·∫≠n d·ª•ng' ? 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300' :
                question.level === 'V·∫≠n d·ª•ng cao' ? 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-300' :
                'bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900'
            }`;
            
            document.getElementById('questionText').textContent = question.question;
            
            const answerButtons = document.querySelectorAll('.answer-btn');
            const answerTexts = document.querySelectorAll('.answer-text');
            
            answerButtons.forEach((btn, index) => {
                btn.className = 'answer-btn bg-gray-50 dark:bg-gray-700 hover:bg-blue-50 dark:hover:bg-blue-900 border-2 border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 rounded-xl p-4 text-left transition-all duration-300';
                btn.disabled = false;
                answerTexts[index].textContent = question.answers[index];
            });
            
            document.getElementById('hintSection').classList.add('hidden');
            
            timeLeft = 60;
            startTimer();
        }

        function startTimer() {
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                const timerElement = document.getElementById('timer');
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 10) {
                    timerElement.classList.add('timer-warning');
                    if (timeLeft <= 5) {
                        playTickSound(); // Play tick sound in last 5 seconds
                    }
                } else {
                    timerElement.classList.remove('timer-warning');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    selectAnswer(-1);
                }
            }, 1000);
        }

        function selectAnswer(selectedIndex) {
            clearInterval(timer);
            const question = shuffledQuestions[currentQuestionIndex];
            const answerButtons = document.querySelectorAll('.answer-btn');
            
            answerButtons.forEach(btn => btn.disabled = true);
            
            userAnswers.push({
                question: question.question,
                level: question.level,
                userAnswer: selectedIndex >= 0 ? question.answers[selectedIndex] : "H·∫øt th·ªùi gian",
                correctAnswer: question.answers[question.correct],
                isCorrect: selectedIndex === question.correct
            });
            
            if (selectedIndex === question.correct) {
                // Play success sound and visual effects
                playCorrectSound();
                answerButtons[selectedIndex].classList.add('correct-answer');
                answerButtons[selectedIndex].className = answerButtons[selectedIndex].className.replace('bg-gray-50 dark:bg-gray-700', 'bg-green-100 dark:bg-green-800').replace('border-gray-200 dark:border-gray-600', 'border-green-500 dark:border-green-400');
                score++;
                correctAnswersCount++;
                
                setTimeout(() => {
                    nextQuestion();
                }, 1500);
            } else {
                // Play error sound and visual effects
                playWrongSound();
                if (selectedIndex >= 0) {
                    answerButtons[selectedIndex].classList.add('wrong-answer');
                    answerButtons[selectedIndex].className = answerButtons[selectedIndex].className.replace('bg-gray-50 dark:bg-gray-700', 'bg-red-100 dark:bg-red-800').replace('border-gray-200 dark:border-gray-600', 'border-red-500 dark:border-red-400');
                }
                
                answerButtons[question.correct].className = answerButtons[question.correct].className.replace('bg-gray-50 dark:bg-gray-700', 'bg-green-100 dark:bg-green-800').replace('border-gray-200 dark:border-gray-600', 'border-green-500 dark:border-green-400');
                
                document.getElementById('hintText').textContent = question.hint;
                document.getElementById('hintSection').classList.remove('hidden');
                
                setTimeout(() => {
                    nextQuestion();
                }, 3000);
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < shuffledQuestions.length) {
                loadQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            // Update total score
            totalScore += score;
            localStorage.setItem('powerGameTotalScore', totalScore.toString());
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('correctAnswers').textContent = `${correctAnswersCount}/${shuffledQuestions.length} c√¢u ƒë√∫ng`;
            document.getElementById('totalScore').textContent = `T·ªïng ƒëi·ªÉm t√≠ch l≈©y: ${totalScore}`;
            
            let resultMessage = "";
            let emoji = "";
            const percentage = (score / shuffledQuestions.length) * 100;
            
            if (percentage >= 90) {
                resultMessage = "Xu·∫•t s·∫Øc! B·∫°n ƒë√£ n·∫Øm v·ªØng ki·∫øn th·ª©c v·ªÅ l≈©y th·ª´a!";
                emoji = "üèÜ";
            } else if (percentage >= 75) {
                resultMessage = "T·ªët l·∫Øm! B·∫°n ƒë√£ hi·ªÉu kh√° t·ªët v·ªÅ l≈©y th·ª´a!";
                emoji = "üéâ";
            } else if (percentage >= 50) {
                resultMessage = "Kh√° t·ªët! H√£y √¥n t·∫≠p th√™m ƒë·ªÉ c·∫£i thi·ªán!";
                emoji = "üëç";
            } else {
                resultMessage = "C·∫ßn c·ªë g·∫Øng th√™m! H√£y xem l·∫°i l√Ω thuy·∫øt v√† luy·ªán t·∫≠p nhi·ªÅu h∆°n!";
                emoji = "üí™";
            }
            
            document.getElementById('resultMessage').textContent = resultMessage;
            document.getElementById('resultEmoji').textContent = emoji;
        }

        function restartGame() {
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }

        function reviewAnswers() {
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('reviewScreen').classList.remove('hidden');
            
            const reviewContent = document.getElementById('reviewContent');
            reviewContent.innerHTML = '';
            
            userAnswers.forEach((answer, index) => {
                const reviewItem = document.createElement('div');
                reviewItem.className = `p-4 rounded-lg border-l-4 ${answer.isCorrect ? 'bg-green-50 dark:bg-green-900 border-green-400 dark:border-green-500' : 'bg-red-50 dark:bg-red-900 border-red-400 dark:border-red-500'}`;
                
                reviewItem.innerHTML = `
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-xs sm:text-sm font-medium px-2 py-1 rounded ${
                                    answer.level === 'Nh·∫≠n bi·∫øt' ? 'bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-300' :
                                    answer.level === 'Th√¥ng hi·ªÉu' ? 'bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-300' :
                                    answer.level === 'V·∫≠n d·ª•ng' ? 'bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-300' :
                                    answer.level === 'V·∫≠n d·ª•ng cao' ? 'bg-purple-100 dark:bg-purple-800 text-purple-800 dark:text-purple-300' :
                                    'bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900'
                                }">
                                    ${answer.level}
                                </span>
                                <span class="text-xs sm:text-sm text-gray-500 dark:text-gray-400">C√¢u ${index + 1}</span>
                            </div>
                            <p class="font-medium text-gray-800 dark:text-gray-200 mb-2 text-sm sm:text-base">${answer.question}</p>
                            <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-400">
                                <span class="font-medium">B·∫°n ch·ªçn:</span> ${answer.userAnswer}
                            </p>
                            <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-400">
                                <span class="font-medium">ƒê√°p √°n ƒë√∫ng:</span> ${answer.correctAnswer}
                            </p>
                        </div>
                        <div class="text-xl sm:text-2xl ml-2 sm:ml-4">
                            ${answer.isCorrect ? '‚úÖ' : '‚ùå'}
                        </div>
                    </div>
                `;
                
                reviewContent.appendChild(reviewItem);
            });
        }

        function backToResult() {
            document.getElementById('reviewScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
        }

        // Initialize theme on page load
        window.addEventListener('load', function() {
            loadTheme();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9695ffe9e2a91069',t:'MTc1NDIyNjA0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
